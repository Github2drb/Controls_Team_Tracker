
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Team Project Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --primary: #2f7bf5;
      --bg: #f7f9fc;
      --text: #1f2937;
      --muted: #6b7280;
      --border: #e5e7eb;
      --good: #16a34a;
      --warn: #f59e0b;
      --bad: #ef4444;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    body { margin: 0; background: var(--bg); color: var(--text); }
    header { background: white; border-bottom: 1px solid var(--border); padding: 16px 20px; position: sticky; top: 0; z-index: 10; }
    header h1 { margin: 0 0 4px; font-size: 20px; }
    header p { margin: 0; color: var(--muted); font-size: 13px; }
    .container { max-width: 1160px; margin: 24px auto; padding: 0 20px; }
    .section-title { margin: 0 0 10px; font-size: 18px; font-weight: 700; display: flex; align-items: center; gap: 8px; }

    /* Buttons & Inputs */
    select, input, button, textarea {
      border: 1px solid var(--border); border-radius: 8px; padding: 10px; font-size: 14px; background: white;
    }
    button.primary { background: var(--primary); color: white; border: none; }
    button.ghost { background: white; color: var(--primary); border: 1px solid var(--primary); }
    button:disabled { opacity: .5; cursor: not-allowed; }

    /* Toolbar */
    .toolbar { display: grid; grid-template-columns: 200px 1fr auto; gap: 12px; align-items: center; margin-bottom: 16px; }

    /* Calendar */
    .calendar-wrap { background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin-bottom: 20px; }
    .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    .cal-title { font-weight: 700; font-size: 16px; }
    .cal-subtitle { color: var(--muted); margin-left: 8px; font-weight: 500; }
    .cal-actions { display: flex; gap: 8px; }
    .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; }
    .cal-day, .cal-dow { text-align: center; padding: 10px; border-radius: 8px; }
    .cal-dow { font-weight: 600; color: var(--muted); }
    .cal-day { background: #fafafa; border: 1px solid var(--border); position: relative; }
    .cal-day.today { outline: 2px solid var(--primary); }
    .cal-day.has-activity::after {
      content: "‚Ä¢";
      position: absolute; bottom: 6px; right: 8px; color: var(--good); font-weight: 700;
    }
    .muted { color: var(--muted); font-size: 12px; }

    /* Table */
    table { width: 100%; border-collapse: collapse; background: white; border: 1px solid var(--border); border-radius: 12px; overflow: hidden; }
    th, td { padding: 10px; border-bottom: 1px solid var(--border); font-size: 14px; }
    th { background: #f3f4f6; text-align: left; }
    tr:last-child td { border-bottom: none; }

    /* Modal */
    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.35); display: none; align-items: center; justify-content: center; z-index: 100; }
    .modal { width: 560px; max-width: 92vw; background: white; border-radius: 12px; border: 1px solid var(--border); overflow: hidden; }
    .modal header { padding: 12px 16px; border-bottom: 1px solid var(--border); }
    .modal header h3 { margin: 0; font-size: 16px; }
    .modal .body { padding: 16px; display: grid; gap: 10px; }
    .modal .footer { padding: 12px 16px; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 8px; }
    .inline { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

    /* Admin Panel */
    .admin-bar { display:flex; gap:8px; margin-bottom: 16px; }
    .panel { background:white; border:1px solid var(--border); border-radius:12px; padding:16px; margin-bottom:20px; }
    .panel h3 { margin:0 0 8px; font-size:16px; }
    .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .grid-3 { display:grid; grid-template-columns:repeat(3, 1fr); gap:12px; }
    .help { background:#fff7ed; border:1px solid #fed7aa; color:#9a3412; padding:10px; border-radius:8px; }

    .pill { display:inline-block; padding:4px 8px; background:#eef2ff; color:#3730a3; border:1px solid #c7d2fe; border-radius:999px; font-size:12px; }
  </style>
</head>
<body>
  <header>
    <h1>Team Project Tracker</h1>
    <p>Track project assignments, calendar activities, and manage data via Admin Panel</p>
  </header>

  <main class="container">
    <!-- ===== Admin Panel Toggle ===== -->
    <div class="admin-bar">
      <button id="openAdmin" class="ghost">üîê Admin Panel</button>
      <span class="pill" id="dataStatus">Data: <strong>Loading‚Ä¶</strong></span>
    </div>

    <!-- ===== Admin Panel (Password Protected) ===== -->
    <section id="adminSection" class="panel" style="display:none">
      <h3>Admin Panel Access</h3>
      <div id="adminLogin" class="grid-3">
        <div>
          <label>Password</label>
          <input type="password" id="adminPassword" placeholder="Enter admin password" />
        </div>
        <div style="display:flex; gap:8px; align-items:flex-end">
          <button id="adminAccess" class="primary">Access Admin</button>
          <button id="adminCancel" class="ghost">Cancel</button>
        </div>
      </div>

      <div id="adminBody" style="display:none">
        <!-- Admin Actions -->
        <div class="grid-3">
          <div>
            <h4>‚öôÔ∏è Admin Actions</h4>
            <div style="display:flex; gap:8px; flex-wrap:wrap">
              <button id="adminExit" class="ghost">Exit Admin Panel</button>
              <button id="adminViewPw" class="ghost">View Current Password</button>
            </div>
          </div>
          <div>
            <h4>üîë Change Admin Password</h4>
            <div style="display:flex; gap:8px">
              <input type="password" id="adminNewPw" placeholder="New Password" />
              <button id="adminUpdatePw" class="primary">Update Password</button>
            </div>
          </div>
          <div>
            <h4>üì¶ Live Data Sync</h4>
            <p><strong id="countAssignments">0</strong> active assignments</p>
            <p>Status: <span id="syncStatus">Ready</span></p>
            <div style="display:flex; gap:8px; flex-wrap:wrap">
              <button id="adminDownloadJson" class="ghost">üì• Download JSON</button>
              <button id="adminExportCsv" class="ghost">üìä Export to CSV</button>
              <button id="adminClearAll" class="ghost">üóëÔ∏è Clear All Data</button>
            </div>
            <div class="help" style="margin-top:10px">
              <strong>How to use with GitHub:</strong>
              <ol style="margin:6px 0 0 18px">
                <li>Upload <code>index.html</code> and <code>data.json</code> to GitHub</li>
                <li>Enable GitHub Pages in repository settings</li>
                <li>Share the live link ‚Äî data loads automatically from <code>data.json</code></li>
                <li>Update <code>data.json</code> in the repository to sync changes across all users</li>
              </ol>
            </div>
          </div>
        </div>

        <!-- Add Assignment -->
        <div class="panel" style="margin-top:16px">
          <h3>‚ûï Add New Project Assignment</h3>
          <div class="grid-3">
            <div>
              <label>Project Name *</label>
              <input type="text" id="addProjectName" placeholder="Project name" />
            </div>
            <div>
              <label>Team Engineer Name *</label>
              <input type="text" id="addEngineerName" placeholder="Engineer name" />
            </div>
            <div>
              <label>Status</label>
              <select id="addStatus">
                <option>In Progress</option>
                <option>Completed</option>
                <option>On Hold</option>
                <option>At Risk</option>
              </select>
            </div>
          </div>
          <div class="grid-3" style="margin-top:10px">
            <div>
              <label>Start Date *</label>
              <input type="date" id="addStartDate" />
            </div>
            <div>
              <label>End Date *</label>
              <input type="date" id="addEndDate" />
            </div>
            <div>
              <label>Notes</label>
              <input type="text" id="addNotes" placeholder="Optional notes" />
            </div>
          </div>
          <div style="margin-top:10px; display:flex; gap:8px">
            <button id="addAssignmentBtn" class="primary">‚ûï Add Assignment</button>
            <span class="muted">New assignments are saved locally and available in <em>Download JSON</em>.</span>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== üîç View Active Assignments (Toolbar) ===== -->
    <h2 class="section-title">üîç View Active Assignments</h2>
    <div class="toolbar">
      <select id="filterBy">
        <option value="all">All Assignments</option>
        <option value="project">By Project</option>
        <option value="engineer">By Engineer</option>
      </select>

      <div id="dynamicSelectWrap" style="display:flex; gap:8px">
        <select id="projectSelect" style="display:none">
          <option value="">Select Project...</option>
        </select>
        <select id="engineerSelect" style="display:none">
          <option value="">Select Engineer...</option>
        </select>
      </div>

      <div style="display:flex; gap:8px;">
        <button id="downloadJson" class="ghost">üì• Download JSON</button>
        <button id="clearData" class="ghost">üóëÔ∏è Clear All Data</button>
      </div>
    </div>

    <!-- ===== üóìÔ∏è Calendar View - Project Timeline (TOP, below toolbar) ===== -->
    <section id="calendarSection" class="calendar-wrap" style="display:none" aria-label="Calendar View - Project Timeline">
      <div class="cal-header">
        <div class="cal-title">
          üóìÔ∏è Calendar View ‚Äì Project Timeline
          <span class="cal-subtitle" id="calendarEngineer"></span>
        </div>
        <div class="cal-actions">
          <button id="prevMonth" class="ghost" aria-label="Previous month">‚óÄ</button>
          <button id="nextMonth" class="ghost" aria-label="Next month">‚ñ∂</button>
          <button id="todayTaskBtn" class="primary">‚ûï Today‚Äôs Task</button>
        </div>
      </div>
      <div class="muted" id="calendarTitle" style="margin-bottom:8px;"></div>
      <div class="cal-grid" id="calGridDOW"></div>
      <div class="cal-grid" id="calGrid"></div>
    </section>

    <!-- ===== üìä All Active Assignments ===== -->
    <h2 class="section-title">üìä All Active Assignments</h2>
    <table id="assignmentsTable" aria-label="All Active Assignments">
      <thead>
        <tr>
          <th>Project Name</th>
